<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Organizations</title>
<style>
    .stars {
        display: inline-block;
        unicode-bidi: bidi-override;
        color: #ffd700;
        font-size: 20px;
        width: auto;
    }
    .stars::before {
        content: "★★★★★";
        letter-spacing: 1px;
        background: linear-gradient(90deg, #ffd700 calc(var(--rating) * 20%), #d3d3d3 calc(var(--rating) * 20%));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }
    .filter-container {
        margin-bottom: 20px;
    }
</style>
</head>
<body>
    <a href="adminDashboard.html"><button>Return to Dashboard</button></a>

<h2>Organizations</h2>

<div class="filter-container">
    <input type="text" id="search-input" placeholder="Search organization...">
    <button onclick="search(0)">Search</button>

    <select id="filter-select">
        <option value="">All</option>
        <option value="Health">Health</option>
        <option value="Education">Education</option>
        <option value="Orphanage">Orphanage</option>
        <option value="Refugee">Refugee</option>
    </select>
    <button onclick="filter(1)">Filter</button>
</div>

<table id="organizationsTable">
    <thead>
        <tr id="hardcodedRow2">
            <th>Organization Name</th>
            <th>Type</th>
            <th>Donations Received</th>
            <th>Rating</th>
            <th>Complaints</th>
            <th>Submissions</th>
        </tr>
    </thead>
    <tbody id="table-body">
        <tr id="row1" class="row" onclick="passToNextPage(1)">
            <td name="name">Charity A</td>
            <td name="type">Orphanage</td>
            <td name="donationsReceived">123</td>
            <td name="rating" rating="4"><div class="stars" style="--rating: 4;"></div></td>
            <td name="complaints">0</td>
            <td name="submissions">Pending submission</td>
        </tr>
        <tr id="row2" class="row" onclick="passToNextPage(2)">
            <td name="name">Charity B</td>
            <td name="type">Charity</td>
            <td name="donationsReceived">1023</td>
            <td name="rating" rating="2"><div class="stars" style="--rating: 2;"></div></td>
            <td name="complaints">3</td>
            <td name="submissions">Pending submission</td>
        </tr>
        <tr id="row3" class="row" onclick="passToNextPage(3)">
            <td name="name">Charity C</td>
            <td name="type">Refugee</td>
            <td name="donationsReceived">13</td>
            <td name="rating" rating="1"><div class="stars" style="--rating: 1;"></div></td>
            <td name="complaints">0</td>
            <td name="submissions">Pending submission</td>
        </tr>
        <tr id="row4" class="row" onclick="passToNextPage(4)">
            <td name="name">Charity D</td>
            <td name="type">Education</td>
            <td name="donationsReceived">10</td>
            <td name="rating" rating="5"><div class="stars" style="--rating: 5;"></div></td>
            <td name="complaints">5</td>
            <td name="submissions">No pending submission</td>
        </tr>
    </tbody>
</table>

<script>

function filter(indexOfColumn) {
    const tableBody = document.getElementById("table-body")
    const filterSelect = document.getElementById('filter-select')
    document.getElementById('search-input').value = ""; // Reset Search
    const selectValue = filterSelect.value
    const rows = document.getElementsByClassName("row")
    for (const row of rows) {
        const rowValues = row.children;
        const rowValue = rowValues.item(indexOfColumn).textContent
        console.log(rowValue,selectValue)
        if(selectValue=="All" || selectValue==""){
            row.style.display = ''
        }
        if (rowValue != selectValue) {
            row.style.display = 'none'
        }else{
            row.style.display = ''
        }
    }
}

function search(indexOfColumn){
    const tableBody = document.getElementById("table-body")
    const inputValue = document.getElementById('search-input').value.toLowerCase()
    document.getElementById('filter-select').value = "";
    const rows = document.getElementsByClassName("row")
    for (const row of rows) {
        const rowValues = row.children;
        const columnValue = rowValues.item(indexOfColumn).textContent
        if(inputValue==""){
            row.style.display = ''
        }
        if (!columnValue.toLowerCase().includes(inputValue)) {
            row.style.display = 'none'
        }else{
            row.style.display = ''
        }
    }
}

function passToNextPage(id) {

    const row = document.getElementById("row"+id)
    var obj = {}

    for (const child of row.children) {
        const name = child.getAttribute("name")
        var value = child.innerHTML;
        if(name=="rating"){
            value = child.getAttribute("rating")
        }
        obj = {...obj,[name]:value}
    }
    
    window.location = "organization.html?" + encodeURIComponent(JSON.stringify(obj));
}

// function passToNextPage(name, donations, rating, complaints, submissions) {
//     var obj = {
//         name: name,
//         donations: donations,
//         rating: rating,
//         complaints: complaints,
//         submissions: submissions
//     };
//     window.location = "organization.html?" + encodeURIComponent(JSON.stringify(obj));
// }

</script>

</body>
</html>
